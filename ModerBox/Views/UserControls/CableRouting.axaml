<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:vm="using:ModerBox.ViewModels"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="550"
             x:DataType="vm:CableRoutingViewModel"
             x:Class="ModerBox.Views.UserControls.CableRouting">
    <Design.DataContext>
        <vm:CableRoutingViewModel/>
    </Design.DataContext>
    
    <StackPanel Margin="20" Spacing="10">
        <!-- 标题说明 -->
        <TextBlock Text="电缆走向自动化绘制" FontSize="18" FontWeight="Bold" Margin="0 0 0 10"/>
        <TextBlock Text="在底图上根据配置文件中的点位数据自动生成电缆走向图" 
                   Foreground="Gray" Margin="0 0 0 10"/>
        
        <!-- 配置文件选择 -->
        <TextBlock Text="配置文件 (JSON)" />
        <Grid ColumnDefinitions="*, Auto, Auto">
            <TextBox Grid.Column="0" Margin="0 0 5 0" 
                     Watermark="选择或输入配置文件路径" 
                     Text="{Binding ConfigFilePath}"/>
            <Button Grid.Column="1" Margin="0 0 5 0" Content="..." 
                    Command="{Binding SelectConfigFile}" Width="40"/>
            <Button Grid.Column="2" Content="创建示例" 
                    Command="{Binding CreateSampleConfig}"/>
        </Grid>
        
        <!-- 底图选择 -->
        <TextBlock Text="底图路径 (可选，覆盖配置文件中的设置)" Margin="0 10 0 0"/>
        <Grid ColumnDefinitions="*, Auto">
            <TextBox Grid.Column="0" Margin="0 0 5 0" 
                     Watermark="选择底图文件 (JPG/PNG)" 
                     Text="{Binding BaseImagePath}"/>
            <Button Grid.Column="1" Content="..." 
                    Command="{Binding SelectBaseImage}" Width="40"/>
        </Grid>
        
        <!-- 输出路径选择 -->
        <TextBlock Text="输出路径 (可选，覆盖配置文件中的设置)" Margin="0 10 0 0"/>
        <Grid ColumnDefinitions="*, Auto">
            <TextBox Grid.Column="0" Margin="0 0 5 0" 
                     Watermark="选择输出文件路径" 
                     Text="{Binding OutputPath}"/>
            <Button Grid.Column="1" Content="..." 
                    Command="{Binding SelectOutputPath}" Width="40"/>
        </Grid>
        
        <!-- 开始按钮 -->
        <Button Margin="0 15 0 0" Content="开始绘制" 
                Command="{Binding RunRouting}"
                HorizontalAlignment="Stretch"
                HorizontalContentAlignment="Center"
                IsEnabled="{Binding !IsRunning}"/>
        
        <!-- 进度条 -->
        <ProgressBar Height="20" Margin="0 10 0 0"
                     Minimum="0" Maximum="{Binding ProgressMax}" 
                     Value="{Binding Progress}"
                     ShowProgressText="True"
                     IsVisible="{Binding IsRunning}"/>
        
        <!-- 日志输出 -->
        <TextBlock Text="执行日志" Margin="0 10 0 5"/>
        <TextBox Height="200" 
                 AcceptsReturn="True" 
                 IsReadOnly="True"
                 TextWrapping="Wrap"
                 Text="{Binding LogOutput}"
                 FontFamily="Consolas, Microsoft YaHei"
                 FontSize="12"/>
    </StackPanel>
</UserControl>
