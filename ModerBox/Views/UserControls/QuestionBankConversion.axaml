<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:vm="using:ModerBox.ViewModels"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:ui="using:FluentAvalonia.UI.Controls"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="600"
             x:DataType="vm:QuestionBankConversionViewModel"
             x:Class="ModerBox.Views.UserControls.QuestionBankConversion">
    <UserControl.Resources>
        <ResourceDictionary>
            <SolidColorBrush x:Key="QbPanelBackgroundBrush" Color="#F5F5F5" />
            <SolidColorBrush x:Key="QbStatusBackgroundBrush" Color="#E3F2FD" />
            <SolidColorBrush x:Key="QbStatusBorderBrush" Color="#2196F3" />
            <ResourceDictionary.ThemeDictionaries>
                <ResourceDictionary x:Key="Dark">
                    <SolidColorBrush x:Key="QbPanelBackgroundBrush" Color="#2A2F36" />
                    <SolidColorBrush x:Key="QbStatusBackgroundBrush" Color="#1B3354" />
                    <SolidColorBrush x:Key="QbStatusBorderBrush" Color="#64B5F6" />
                </ResourceDictionary>
            </ResourceDictionary.ThemeDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>
    <Design.DataContext>
        <vm:QuestionBankConversionViewModel/>
    </Design.DataContext>

    <ScrollViewer>
        <StackPanel Margin="20" Spacing="15">
            <!-- 标题 -->
            <TextBlock Text="题库转换工具" FontSize="24" FontWeight="Bold" Margin="0 0 0 10"/>
            
            <!-- 说明 -->
            <ui:InfoBar Title="功能说明"
                        Severity="Informational"
                        IsClosable="False"
                        IsOpen="True"
                        Margin="0 0 0 10"
                        Padding="15">
                <StackPanel Spacing="5">
                    <TextBlock Text="• 支持从多种格式的题库文件读取题目" TextWrapping="Wrap"/>
                    <TextBlock Text="• 支持导出为考试宝、磨题帮格式" TextWrapping="Wrap"/>
                    <TextBlock Text="• 支持单选题、多选题、判断题" TextWrapping="Wrap"/>
                </StackPanel>
            </ui:InfoBar>

            <!-- 源文件选择 -->
            <StackPanel Spacing="8">
                <TextBlock Text="源文件" FontWeight="SemiBold"/>
                <Grid ColumnDefinitions="*,Auto">
                    <TextBox Grid.Column="0" 
                             Margin="0 0 10 0" 
                             Watermark="选择题库源文件" 
                             Text="{Binding SourceFile}"
                             IsReadOnly="True"/>
                    <Button Grid.Column="1" 
                            Content="浏览..." 
                            Command="{Binding SelectSourceFile}" 
                            Width="100"/>
                </Grid>
            </StackPanel>

            <!-- 源格式选择 -->
            <StackPanel Spacing="8">
                <TextBlock Text="源格式" FontWeight="SemiBold"/>
                <ComboBox ItemsSource="{Binding SourceFormatOptions}"
                          SelectedItem="{Binding SelectedSourceFormat}"
                          DisplayMemberBinding="{Binding DisplayName}"
                          HorizontalAlignment="Stretch"/>
            </StackPanel>

            <!-- 目标格式选择 -->
            <StackPanel Spacing="8">
                <TextBlock Text="目标格式" FontWeight="SemiBold"/>
                <ComboBox ItemsSource="{Binding TargetFormatOptions}"
                          SelectedItem="{Binding SelectedTargetFormat}"
                          DisplayMemberBinding="{Binding DisplayName}"
                          HorizontalAlignment="Stretch"/>
            </StackPanel>

            <!-- 目标文件选择 -->
            <StackPanel Spacing="8">
                <TextBlock Text="目标文件" FontWeight="SemiBold"/>
                <Grid ColumnDefinitions="*,Auto">
                    <TextBox Grid.Column="0" 
                             Margin="0 0 10 0" 
                             Watermark="选择保存位置" 
                             Text="{Binding TargetFile}"
                             IsReadOnly="True"/>
                    <Button Grid.Column="1" 
                            Content="浏览..." 
                            Command="{Binding SelectTargetFile}" 
                            Width="100"/>
                </Grid>
            </StackPanel>

            <!-- 转换按钮 -->
        <Button Content="开始转换"
            Command="{Binding RunConversion}"
            HorizontalAlignment="Stretch"
            Height="40"
            FontSize="16"
            Margin="0 10 0 0"/>

        <ProgressBar IsIndeterminate="True" IsVisible="{Binding IsBusy}" Height="4"/>

            <!-- 状态显示 -->
            <ui:InfoBar Title="状态"
                        IsOpen="True"
                        IsClosable="False"
                        Severity="{Binding StatusSeverity}"
                        Message="{Binding Status}"/>

            <!-- 支持的格式说明 -->
            <ui:InfoBar Title="支持的格式说明"
                        Severity="Informational"
                        IsClosable="False"
                        IsOpen="True"
                        Padding="15">
                <StackPanel Spacing="10">
                    <StackPanel Spacing="5">
                        <TextBlock Text="源格式：" FontWeight="Bold"/>
                        <TextBlock Text="• TXT文本：从Word格式题库转换的文本文件" TextWrapping="Wrap"/>
                        <TextBlock Text="• 网络大学Excel：标准网络大学题库格式（G列题干，F列题型）" TextWrapping="Wrap"/>
                        <TextBlock Text="• 网络大学4列：简化版网络大学格式（4列数据）" TextWrapping="Wrap"/>
                        <TextBlock Text="• EXC格式：特定的Excel题库格式" TextWrapping="Wrap"/>
                    </StackPanel>

                    <StackPanel Spacing="5">
                        <TextBlock Text="目标格式：" FontWeight="Bold"/>
                        <TextBlock Text="• 考试宝：适用于考试宝App的题库格式" TextWrapping="Wrap"/>
                        <TextBlock Text="• 磨题帮：适用于磨题帮App的题库格式" TextWrapping="Wrap"/>
                    </StackPanel>
                </StackPanel>
            </ui:InfoBar>
        </StackPanel>
    </ScrollViewer>
</UserControl>
