# ModerBox 通道差值分析功能使用指南

## 功能简介

通道差值分析功能已成功集成到ModerBox Avalonia UI应用程序中，提供了一个用户友好的界面来分析波形文件中的特定通道数据。

## 如何使用

### 1. 启动应用程序
运行ModerBox应用程序后，您会在左侧导航菜单中看到"通道差值分析"选项，图标为计算器。

### 2. 界面功能

#### 基本设置
- **波形文件夹路径**：点击"浏览..."按钮选择包含波形文件的文件夹
- **输出Excel文件路径**：点击"浏览..."按钮选择保存结果的Excel文件位置
- **设备名称列表**：输入要分析的设备名称，用逗号分隔（默认：S2P1A,S2P1B,S2P2A,S2P2B）

#### 高级选项
- **子级过滤器**：用于匹配文件名中的特定部分（默认：Child0）
- **使用极性相关的文件名匹配规则**：根据需要选择是否使用极性

### 3. 操作步骤

1. **选择源文件夹**：点击波形文件夹路径旁的"浏览..."按钮，选择包含Comtrade波形文件的文件夹
2. **选择输出位置**：点击输出Excel文件路径旁的"浏览..."按钮，选择结果保存位置
3. **配置设备名称**：在设备名称列表中输入要分析的设备，多个设备用逗号分隔
4. **配置高级选项**（可选）：展开高级选项设置子级过滤器和极性选项
5. **开始分析**：点击"开始分析"按钮执行分析
6. **查看进度**：通过进度条和状态信息了解处理进度
7. **获取结果**：分析完成后，Excel文件将保存到指定位置

### 4. 分析结果

生成的Excel文件包含以下列：
- 文件名：波形文件的名称
- 点序号：在该文件中的数据点序号
- IDEL1：第一个IDEL通道
- IDEL2：第二个IDEL通道  
- IDEE1：第一个IDEE通道
- IDEE2：第二个IDEE通道
- IDEL1-IDEL2：第一组差值
- IDEE1-IDEE2：第二组差值

### 5. 功能特点

- **实时进度显示**：处理过程中显示实时进度和状态信息
- **错误处理**：自动处理和显示错误信息
- **文件验证**：自动验证文件和文件夹的有效性
- **批量处理**：支持同时处理多个设备的波形文件
- **自动格式化**：结果自动格式化为Excel表格，包含筛选器和冻结行

### 6. 注意事项

- 确保选择的文件夹包含有效的Comtrade波形文件（.cfg和.dat文件）
- 所有波形文件必须包含所需的四个通道（IDEL1、IDEL2、IDEE1、IDEE2）
- 处理大量文件时可能需要较长时间，请耐心等待
- 确保有足够的磁盘空间来保存结果文件

### 7. 故障排除

- 如果找不到匹配的文件，请检查设备名称和子级过滤器设置
- 如果分析失败，请检查波形文件是否包含所需的通道
- 如果文件选择失败，请确保有足够的权限访问目标文件夹

## 技术实现

该功能基于以下技术栈：
- **前端**：Avalonia UI with MVVM模式
- **后端**：.NET 8.0
- **数据处理**：ModerBox.Comtrade.PeriodicWork项目
- **Excel导出**：ClosedXML库
- **测试**：MSTest框架，包含单元测试

## 开发者信息

- 遵循MVVM设计模式
- 支持响应式UI更新
- 包含完整的单元测试覆盖
- 符合项目现有的代码风格和架构 